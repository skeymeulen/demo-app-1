version: 2.1

jobs:
  run-aikio-scan:
    docker:
      - image: aikidosecurity/local-scanner:latest

    steps:
      - checkout:
          path: my-app
      - run:
          name: "Run Aikido scan"
          command: aikido-local-scanner scan my-app --repositoryname my-circleci-app --branchname main --apikey AIK_CI_X0oCFY7T9POOiTkewXJBRtxTF0J2e5vCIv1XISLPrj18CjCt00yvuiJv59OJAywt
workflows:
  my-workflow:
    triggers:
      branches:
          only:
              - main
              - circleci-project-setup
    jobs:
      - run-aikio-scan
